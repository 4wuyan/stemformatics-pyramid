var module={};function round_to_two_decimal_places(a){new_num=Math.round(a*100)/100;return new_num}increment_value=1;var tip=d3.tip().attr("class","d3-tip").html(function(a){sample_type=a.sample_type;temp="Sample Type: "+sample_type+"<br/>";return temp});function run_scatter_gene_expression_graph(w,g,l,i,e,k,o,j,d,r,f,q){j=false;var s=l.split(",").length;div_name="content"+r.ds_id;var p=d3.tip().attr("class","d3-tip").attr("id","tooltip_multiview_"+r.ds_id).offset([100,400]).html(function(){temp="Title - "+r.Title;return temp});var b=d3.tip().attr("class","d3-tip").offset([0,+110]).html(function(x){probe=x.Probe;Expression_Value=round_to_two_decimal_places(x[y_column]);lwr=round_to_two_decimal_places(x.Expression_Value-x.Standard_Deviation);upr=round_to_two_decimal_places(x.Expression_Value+x.Standard_Deviation);temp=f+": "+x.Probe+"<br/>Replicate ID: "+x.Replicate_ID+"<br/>Log2 Expression: "+Expression_Value+" ["+lwr+";"+upr+"]<br/>";return temp});max=0;min=0;number_of_increments=0;count=0;probes_types=new Array();probes=new Array();probe_count=0;sample_types=new Array();sample_type_array=new Array();sample_type_count=0;if(multiview_graph!="yes"){sample_type_hover={}}number_of_colours=39;colour_count=0;data.forEach(function(x){x.Expression_Value=+x.Expression_Value;x.Standard_Deviation=+x.Standard_Deviation;x.Probe=x.Probe;if(x.Expression_Value+x.Standard_Deviation>max){max=x.Expression_Value+x.Standard_Deviation}if(x.Expression_Value-x.Standard_Deviation<min){min=x.Expression_Value-x.Standard_Deviation}if($.inArray(x.Probe,probes_types)==-1){probes_types.push(x.Probe);probe_count++}if($.inArray(x.Sample_Type,sample_type_array)==-1){sample_type_array.push(x.Sample_Type);sample_types[x.Sample_Type]=sample_type_count;sample_type_hover[x.Sample_Type]=x.Sample_Type_Long;sample_type_count++}count++});probes_types=probes_types.sort(sortAlphaNum_array);var h={};h=setup_colours_for_group(probes_types,h,number_of_colours,w);var m={};m=setup_colours_for_group(sample_type_array.sort(),m,number_of_colours,w);number_of_increments=max-min;if(number_of_increments<r.medianDatasetExpression){if(number_of_increments<r.detectionThreshold){number_of_increments=Math.ceil(r.detectionThreshold)}else{number_of_increments=Math.ceil(r.medianDatasetExpression)}}number_of_increments=Math.ceil(number_of_increments);if((number_of_increments*increment_value)<6){number_of_increments=6}if((number_of_increments*increment_value)>10){number_of_increments=10}probes=probes;sample_types=sample_types;probe_count=probe_count;title=o;subtitle1=r.Title;subtitle2=r.cellsSamplesAssayed;target=g;width=data.length*1;horizontal_grid_lines=width;if(width<1000){width=1000}var a=l.split(",");if(a[0]=="Sample Type"){a[0]="Sample_Type"}else{if(a[1]=="Sample Type"){a[1]="Sample_Type"}}var c={split_sort_by_option:a,multi_group:s,legend_list:{name:"probes",list:probes_types},probe_name_for_tooltip:f,colour_array:h,legend_padding:190,legend_rect_size:20,ref_type:q,height:400,width:graph_box_width,margin:{top:250,left:130,bottom:300,right:250},initial_padding:10,x_axis_label_padding:10,text_size:"12px",title_text_size:"16px",tooltip_multiview:p,increment:number_of_increments*increment_value,display:{hoverbars:"no",error_bars:"yes",legend:e,horizontal_lines:"yes",legend_hover:"no",vertical_lines:"yes",x_axis_labels:"yes",y_axis_title:"yes",horizontal_grid_lines:"yes"},circle_radius:2,hover_circle_radius:10,background_colour:"white",background_stroke_colour:"black",background_stroke_width:"1px",colour:w,font_style:"Arial",grid_colour:"black",ref_name:k,grid_opacity:1,y_label_text_size:"14px",y_label_x_val:60,data:data,whiskers_needed:j,sortByOption:l,show_min_y_axis:i,domain_colours:["#FFFFFF","#7f3f98"],error_bar_width:5,error_stroke_width:"1px",error_dividor:100,horizontal_lines:[["Detection Threshold "+r.detectionThreshold,"green",r.detectionThreshold],["Median "+r.medianDatasetExpression,,r.medianDatasetExpression]],horizontal_line_value_column:"value",horizontal_grid_lines:width,legend_class:"legend",legend_range:[0,100],line_stroke_width:"2px",number_of_colours:39,padding:2,probe_count:probe_count,probes:probes_types,second_sort_by_order:"none",sample_type_order:r.sampleTypeDisplayOrder,sample_types:sample_types,subtitles:[subtitle1],stroke_width:"3px",target:target,title:title,title_class:"title",tip:tip,tooltip:b,watermark:"http://www.stemformatics.org/img/logo.gif",x_axis_text_angle:-45,x_axis_title:"Samples",x_column:"Sample_ID",x_middle_title:500,y_axis_title:r.yAxisLabel,y_column:"Expression_Value"};var t=biojsvisscatterplot(c);var u=g;var n=u.getElementsByTagName("svg")[0];var v=(new XMLSerializer).serializeToString(n)};
