large=false;var min_border_margin=200;if(CURRENT_URL.queryKey.size=="large"){large=true;var min_border_margin=400}function set_label_dimensions(){var a=new Object();a.yaxis_ticks_abs_x=195;a.yaxis_label_abs_x=170;a.yaxis_label_abs_y=430;a.yaxis_tick_offset=0.2;a.yaxis_tick_start=0;a.yaxis_tick_steps=1;a.yaxis_decimal_places=0;return a}function graph_data(c,b,a){json_view_data=$("#json_view_data"+c).html();this.view_data=jQuery.parseJSON(json_view_data);this.view_data.graph_id=b;this.view_data.show_standard_deviation="on";this.view_data.original_min_y_axis=this.view_data.min_y_axis;this.view_data.label_dimensions=set_label_dimensions();json_datasets=$("#dataSets").html();this.dataSets=jQuery.parseJSON(json_datasets);this.ds_id=c;this.db_id=a}function selectGraphToDraw(){$("div.displayGraphs").addClass("loading");graph_type=this_graph_data.view_data.graph_type;line_graph_available=this_graph_data.view_data.line_graph_available;if(this_graph_data.view_data.plot_data=="{}"){$("div.loading").removeClass("loading");$(this_graph_data.graph_id).html('<div class="noGraphData">No data found for these parameters.</div>')}else{$("div.majorLabel").removeClass("majorLabel").addClass("majorLabelVertical");switch(graph_type){case"scatter":drawScatterPlot(this_graph_data.view_data);break;case"bar":drawBarPlot(this_graph_data.view_data);break;case"box":this_graph_data.view_data.show_standard_deviation="on";drawBoxPlot(this_graph_data.view_data);$("li.chooseSD").hide();break;case"line":this_graph_data.view_data.show_standard_deviation="on";drawLinePlot(this_graph_data.view_data);$("li.chooseSD").hide();break}}afterGraphDrawn()}function drawScatterPlot(l){var k=l.probe_list;var o=l.plot_data;var m=[];var h=0;var d=0;var g={};var b=l.number_of_samples;min_x_axis=l.min_x_axis;max_x_axis=l.max_x_axis;var e=l.show_standard_deviation;if(e=="on"){sd_data=l.plot_data_sd;for(var f in k){probe_id=k[f];if(sd_data.hasOwnProperty(probe_id)){var c=l.probe_color_dict[probe_id]["color"];for(var j in sd_data[probe_id]){if(sd_data[probe_id].hasOwnProperty(j)){m[h]={data:sd_data[probe_id][j],label:null,color:c,lines:{show:true},bandwidth:{show:true,lineWidth:bandwidth_line_width,lineThickness:2}};h++}}}}}if(l.hasOwnProperty("draw_scatter_with_lines")){draw_scatter_with_lines=l.draw_scatter_with_lines}else{draw_scatter_with_lines=false}for(var f in k){probe_id=k[f];if(o.hasOwnProperty(probe_id)){var c=l.probe_color_dict[probe_id]["color"];m[h]={data:o[probe_id],color:c,label:probe_id,lines:{show:draw_scatter_with_lines},points:{show:true}};h++;d++}}m=set_detection_threshold_and_median(l,m,h);l.flot_data=m;markings=set_markings_to_array(l);var a=l.min_y_axis;var n=l.max_y_axis;var p={xaxis:{min:min_x_axis,max:max_x_axis,ticks:[],mode:null},yaxis:{min:a,max:n,font:{size:0,family:"sans-serif",variant:"small-caps"}},grid:{minBorderMargin:min_border_margin,backgroundColor:"#FFF",markings:markings,hoverable:true}};l.options=p;var i=drawGraph(l)}function drawBarPlot(j){var q=j.plot_data;var l=[];var h=0;var g=Array();markings=set_markings_to_array(j);xaxis_labels=j.xaxis_labels;min_x_axis=j.min_x_axis;max_x_axis=j.max_x_axis;var f=j.show_standard_deviation;for(var i in q){if(q.hasOwnProperty(i)){var e=q[i]["color"];var k=i;for(var o in q[i]["values"]){if(q[i]["values"].hasOwnProperty(o)){var p=q[i]["values"][o]["sd"];var b=q[i]["values"][o]["average"];var n=q[i]["values"][o]["xaxis"];var d=q[i]["values"][o]["extra_info"];var c=q[i]["values"][o]["level_above"];l[h]={data:[[n,b]],color:e,hoverLabel:i+d+" - "+c,label:k,bars:{show:true,barWidth:1,align:"center"}};k=null;h++;if(f=="on"&&p>0){flot_graph_data=new Array();flot_graph_data[0]=new Array();flot_graph_data[1]=new Array();flot_graph_data[0][0]=n;flot_graph_data[0][1]=b+p;flot_graph_data[1][0]=n;flot_graph_data[1][1]=b-p;l[h]={data:flot_graph_data,label:null,color:e,lines:{show:true},bandwidth:{show:true,lineWidth:bandwidth_line_width,lineThickness:3},hoverable:false};h++}}}}}var a=j.min_y_axis;var m=j.max_y_axis;l=set_detection_threshold_and_median(j,l,h);j.flot_data=l;j.options=set_options_bar_and_box(j);drawGraph(j)}function drawBoxPlot(i){var w=i.plot_data;var n=[];var f=0;var h=Array();var e=set_markings_to_array(i);xaxis_labels=i.xaxis_labels;min_x_axis=i.min_x_axis;max_x_axis=i.max_x_axis;var c=0;for(var s in w){if(w.hasOwnProperty(s)){var p=w[s]["color"];for(var u in w[s]["values"]){if(w[s]["values"].hasOwnProperty(u)){var b=w[s]["values"][u]["average"];var t=w[s]["values"][u]["max"];var g=w[s]["values"][u]["median"];var m=w[s]["values"][u]["min"];var a=w[s]["values"][u]["sd"];var d=w[s]["values"][u]["xaxis"];var l=w[s]["values"][u]["Q1"];var k=w[s]["values"][u]["Q3"];var o=w[s]["values"][u]["level_above"];var j=w[s]["values"][u]["extra_info"];var v=s+j+" - "+o;n[f]={data:[[d,t],[d,m]],hoverLabel:v,label:null,color:p,lines:{show:true},bandwidth:{show:true,lineWidth:15,lineThickness:3},hoverable:true};f++;var r=null;if(u==0){r=s}n[f]={data:[[d,k,l]],color:p,hoverLabel:v,label:r,bars:{show:true,barWidth:0.8,align:"center",fill:true,fillColor:p}};f++;n[f]={data:[[d,g,g]],color:"#FFF",label:null,bars:{show:true,barWidth:0.8,align:"center"},hoverable:false};f++}}}}n=set_detection_threshold_and_median(i,n,f);i.flot_data=n;min_y_axis=i.min_y_axis;max_y_axis=i.max_y_axis;i.options=set_options_bar_and_box(i);var q=drawGraph(i)}function set_options_bar_and_box(b){var a={series:{bandwidth:{active:true,drawBandwidth:function(d,h,c,g,f,e){d.beginPath();d.strokeStyle=e;d.lineWidth=1;d.moveTo(c,g);d.stroke();d.beginPath();d.strokeStyle=e;d.lineWidth=h.lineWidth;d.lineThickness=1;d.lineThickness=h.lineThickness;d.moveTo(c,g);d.lineTo(c,g+d.lineThickness);d.stroke()}}},xaxis:{min:b.min_x_axis,max:b.max_x_axis,ticks:b.x_axis_ticks,mode:null,font:{size:0}},yaxis:{min:b.min_y_axis,max:b.max_y_axis,font:{size:0,family:"sans-serif",variant:"small-caps"}},grid:{minBorderMargin:min_border_margin,backgroundColor:"#FFF",markings:markings,hoverable:true}};return a}function drawLinePlot(j){var o=j.plot_data;var k=[];var g=0;var f=set_markings_to_array(j);min_x_axis=j.min_x_axis;max_x_axis=j.max_x_axis;var d="on";var p=0;var e={};list_color_dict={};var i={};if(typeof j.xaxis_labels_original==="undefined"){j.xaxis_labels_original=j.xaxis_labels}for(var h in j.xaxis_labels_original.full){label_name=j.xaxis_labels_original.full[h].name;xaxis_position=j.xaxis_labels_original.full[h].xaxis_position;i[xaxis_position]=label_name}for(var h in o){if(o.hasOwnProperty(h)){values_array=new Array();var q=0;for(var n in o[h]["values"]){var m=o[h]["values"][n]["sd"];var a=o[h]["values"][n]["average"];var l=o[h]["values"][n]["xaxis"];var b=o[h]["values"][n]["extra_info"];var c=o[h]["color"];label=null;values_array[l]=[l,a];if(d=="on"&&m>0){graph_data=new Array();graph_data[0]=new Array();graph_data[1]=new Array();graph_data[0][0]=l;graph_data[0][1]=a+m;graph_data[1][0]=l;graph_data[1][1]=a-m;k[g]={data:graph_data,label:null,color:c,lines:{show:true},bandwidth:{show:true,lineWidth:30,lineThickness:3},hoverable:false};g++}}temp_label=h.split("|");new_label=temp_label[1]+" - "+temp_label[0];k[g]={data:values_array,color:c,hoverLabel:new_label+b,label:label,points:{show:true},lines:{show:true},show_xaxis_labels_full:i};g++}}j.options=set_options_bar_and_box(j);if(j.expand_horizontally||Object.keys(j.xaxis_labels_original.full).length<35){j.xaxis_labels=j.xaxis_labels_original.full}else{j.xaxis_labels=j.xaxis_labels_original.summary}j.flot_data=set_detection_threshold_and_median(j,k,g);drawGraph(j)};